---
title: "ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’ä¿ƒé€²ã™ã‚‹ dbt incremental ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ â€• å…¨æœŸé–“è¿½è·¡ã®ä½ã‚³ã‚¹ãƒˆåŒ–"
emoji: "ğŸ“Š"
type: "idea"
topics: ["dbt", "dataengineering", "ãƒ‡ãƒ¼ã‚¿åˆ†æ"]
published: false
publication_name: "pivotmedia"
---

## 1. ã¯ã˜ã‚ã«

[ãƒ“ã‚¸ãƒã‚¹æ˜ åƒãƒ¡ãƒ‡ã‚£ã‚¢ã€ŒPIVOTã€](https://pivotmedia.co.jp/app) ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã® uma-chan ã§ã™ã€‚

ç§ã¯ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿åˆ©ç”¨ã‚’ä¿ƒé€²ã§ãã‚‹ã‚ˆã†ãªåŸºç›¤ã‚’ä½œã‚‹ã“ã¨ã‚’é‡è¦è¦–ã—ã¦ã„ã¾ã™ã€‚

ä»Šå›ã¯ãã‚Œã‚’å¿µé ­ã«ç½®ãã¤ã¤å…¨æœŸé–“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•ã‚’ä½ã‚³ã‚¹ãƒˆã§è¿½è·¡ã§ãã‚‹ dbt ãƒ¢ãƒ‡ãƒ« [^1] ã‚’è¨­è¨ˆã—ãŸè©±ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’è¶³ãŒã‹ã‚Šã«ã€æ§˜ã€…ãªæ™‚é–“è»¸ã§ã®åˆ†æã‚’ä¿ƒé€²ã§ãã‚Œã°ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚

## 2. å¯¾è±¡èª­è€…

- dbt ã® incremental ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè·µçš„ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’çŸ¥ã‚ŠãŸã„æ–¹
- BigQuery ãªã©ã® DWH ã§ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã«å–ã‚Šçµ„ã‚“ã§ã„ã‚‹æ–¹
- GA4 ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDçµ±ä¸€ï¼ˆ`user_pseudo_id` ã¨ `user_id` ã®ç´ä»˜ã‘ï¼‰ã‚’ã—ã¤ã¤é•·æœŸé–“è¿½è·¡ã‚’å®Ÿç¾ã—ãŸã„æ–¹

dbt ã«è©³ã—ããªã„æ–¹ã«ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã€ä»•çµ„ã¿ã®èª¬æ˜ã‚’äº¤ãˆãªãŒã‚‰ç´¹ä»‹ã—ã¾ã™ã€‚

## 3. èª²é¡Œ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æµå…¥å…ƒåˆ†æã‚’å®Ÿæ–½ã™ã‚‹ä¸­ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚’æ–°è¦ä½œæˆã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã—ãŸã€‚

- æµå…¥å…ƒåˆ¥ã®ç¶™ç¶šç‡åˆ†æï¼ˆåˆå›è¨ªå•ã‹ã‚‰ N é€±é–“å¾Œã«å†è¨ªå•ã—ãŸã‹ãªã©ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆå›è¨ªå•ã‹ã‚‰ç¾çŠ¶ã¾ã§ã®å¤‰åŒ–ã®è¿½è·¡
- é•·æœŸçš„ãªè¦–ç‚¹ã§ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ç²å¾—å“è³ªã®è©•ä¾¡

åˆæœŸå®Ÿè£…ã§ã¯ã‚ã¾ã‚Šæ·±ãè€ƒãˆãšã«ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè£…ã—ãŸã“ã¨ã§ Out Of Memory (OOM) ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã—ãŸã€‚

- FIRST_VALUE/LAST_VALUE ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–¢æ•°ã§å…¨æœŸé–“ãƒ‡ãƒ¼ã‚¿ã‚’èµ°æŸ»
- å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¨æœŸé–“ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒ¢ãƒªã«å±•é–‹

## 4. è¨­è¨ˆã®ãƒã‚¤ãƒ³ãƒˆ

å¿…è¦ä»¥ä¸Šã«é›†è¨ˆã‚³ã‚¹ãƒˆãŒå¢—å¤§ã™ã‚‹ã“ã¨ã‚’é¿ã‘ã‚‹ãŸã‚ã€ã¾ãšæ‰‹å§‹ã‚ã«å…¨æœŸé–“ã‚’ä½ã‚³ã‚¹ãƒˆã§è¿½è·¡ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã€Œincrementalï¼ˆå¢—åˆ†æ›´æ–°ï¼‰ã«å‘ã„ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆã€ã‚’è€ƒãˆã¾ã—ãŸã€‚

### 4.1. dbt ã®è¨­å®š

ã¾ãšã€dbt ã®è¨­å®šã§ incremental ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦å®šç¾©ã—ã¾ã™ã€‚

```sql
{{
    config(
        materialized="incremental",    -- å¢—åˆ†æ›´æ–°ãƒ¢ãƒ¼ãƒ‰
        unique_key="user_id",
        incremental_strategy="merge",  -- æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å·®åˆ†ãŒã‚ã‚‹ã¨ UPDATEã€æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ INSERT
    )
}}
```

### 4.2. é›†è¨ˆæœŸé–“ã®åˆ¶å¾¡

`is_incremental()` ã‚’ä½¿ã£ã¦ã€full-refresh æ™‚ã¨ incremental æ™‚ã§å‡¦ç†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æœŸé–“ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚

```sql
base_events as (
    select user_id, date(event_datetime_jst) as event_date, event_datetime_jst
    from {{ ref("whs_action__ga") }}
    {% if is_incremental() %}
        where
            -- incremental æ™‚ã¯ç›´è¿‘ N æ—¥åˆ†ã®ã¿å‡¦ç† (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ3æ—¥)
            -- NOTE: date() åˆ©ç”¨æ™‚ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã®æ‰±ã„ã«æ³¨æ„
            date(event_datetime_jst) >= date_sub(
                current_date("Asia/Tokyo"),
                interval {{ var("touch_lookback_days", 3) }} day
            )
    {% endif %}
)
```

å¹³å¸¸æ™‚ã¯ incremental ã§ç›´è¿‘3æ—¥åˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ã™ã‚‹ã ã‘ãªã®ã§ã€å‡¦ç†ãƒ‡ãƒ¼ã‚¿é‡ãŒå¤§å¹…ã«å‰Šæ¸›ã•ã‚Œã¾ã™ã€‚

### 4.3. åˆå›è¨ªå•ã¨æœ€çµ‚è¨ªå•ã®ç®¡ç†

incremental å®Ÿè¡Œæ™‚ã¯ã€ç›´è¿‘3æ—¥é–“ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãŒå‡¦ç†å¯¾è±¡ã¨ãªã‚Šã¾ã™ã€‚MERGE ã«ã‚ˆã‚Š unique_key ãŒä¸€è‡´ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒ UPDATE ã•ã‚Œã€åˆå›è¨ªå•ã¯æ—¢å­˜ã¨æ¯”è¼ƒã—ã¦å¤ã„æ–¹ã‚’ä¿æŒã—ã€æœ€çµ‚è¨ªå•ã¯æ–°ã—ã„å€¤ã§ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚

```sql
-- é›†è¨ˆæœŸé–“å†… (base_events) ã‹ã‚‰åˆå›è¨ªå•ã¨æœ€çµ‚è¨ªå•ã‚’é›†ç´„
first_touch as (
    select
        user_id,
        array_agg(event_datetime_jst order by event_datetime_jst asc limit 1)[
            offset(0)
        ] as first_touch_time
    from base_events
    group by user_id
),

last_touch as (
    select
        user_id,
        array_agg(event_datetime_jst order by event_datetime_jst desc limit 1)[
            offset(0)
        ] as last_touch_time
    from base_events
    group by user_id
),

merged_touches as (
    select ft.user_id, ft.first_touch_time, lt.last_touch_time
    from first_touch ft
    left join last_touch lt on ft.user_id = lt.user_id
),

{% if is_incremental() %}
    -- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
    existing_data as (
        select user_id, first_touch_time
        from {{ this }}
        where user_id in (select distinct user_id from base_events)
    ),
{% endif %}

-- æœ€çµ‚çš„ãªãƒãƒ¼ã‚¸
select
    mt.user_id,
    {% if is_incremental() %}
        -- åˆå›è¨ªå•ã¯æ—¢å­˜ã¨æ–°è¦ã§å¤ã„æ–¹ã‚’ä¿æŒ
        case
            when
                ex.first_touch_time is not null
                and ex.first_touch_time <= mt.first_touch_time
            then ex.first_touch_time
            else mt.first_touch_time
        end as first_touch_time,
    {% else %} mt.first_touch_time,
    {% endif %}
    -- æœ€çµ‚è¨ªå•ã¯å¸¸ã«æ–°è¦ãƒ‡ãƒ¼ã‚¿ (base_events å†…ã®æœ€æ–°) ã‚’ä½¿ç”¨
    mt.last_touch_time
from merged_touches mt
{% if is_incremental() %}
    left join existing_data ex on mt.user_id = ex.user_id
{% endif %}
```

ç›´è¿‘3æ—¥é–“ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿ãŒæœ€çµ‚çš„ãª SELECT æ–‡ã§ã‚¯ã‚¨ãƒªã•ã‚Œã‚‹ã“ã¨ã¨ãªã‚Šã¾ã™ã€‚
ãã—ã¦ `incremental_strategy="merge"` ã®ä»•æ§˜ã«ã‚ˆã‚Šæ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã¨ã®å·®åˆ†ãŒã‚ã‚Œã° UPDATE ã•ã‚Œã¾ã™ã€‚

:::message
ã“ã®è¨­è¨ˆãŒ incremental ã¨ç›¸æ€§ãŒè‰¯ã„ã®ã¯ã€Œåˆå›è¨ªå•ã€ã€Œæœ€çµ‚è¨ªå•ã€ãŒå†ªç­‰æ€§ã‚’æŒã¤ï¼ˆä½•åº¦å®Ÿè¡Œã—ã¦ã‚‚çµæœãŒåŒã˜ï¼‰ãŸã‚ã§ã™ã€‚æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨æ–°è¦ãƒ‡ãƒ¼ã‚¿ã®æ¯”è¼ƒã ã‘ã§æ­£ã—ã„çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

é€†ã«ã€Œç´¯ç©ã®è¨ªå•å›æ•°ã€ã®ã‚ˆã†ãªæŒ‡æ¨™ã¯ incremental ã§å˜ç´”å®Ÿè£…ã™ã‚‹ã¨å†å®Ÿè¡Œæ™‚ã«äºŒé‡ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹ãªã©ã®é›†è¨ˆã‚ºãƒ¬ã®æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å ´åˆã¯éå»ãƒ‡ãƒ¼ã‚¿ã‚’éƒ½åº¦å‚ç…§ã™ã‚‹ã€ã‚ã‚‹ã„ã¯é›†è¨ˆæ¸ˆã¿ã®ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”¨æ„ã™ã‚‹ãªã©ã®å¯¾å¿œãŒå¿…è¦ã§ã™ã€‚
:::

### 4.4. ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã®çµ±ä¸€

æœ¬ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€åŒ¿åè¨ªå•æœŸé–“ã‚’å«ã‚ãŸå…¨æœŸé–“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•ã‚’è¿½è·¡ã™ã‚‹ãŸã‚ã€GA4 ã®è¤‡æ•°ã®IDã‚’çµ±ä¸€ã—ã¦ã„ã¾ã™ã€‚

#### 4.4.1. GA4 ã®IDä½“ç³»

- ãƒ­ã‚°ã‚¤ãƒ³å‰: `user_pseudo_id`ï¼ˆåŒ¿åIDã€Cookie/ãƒ‡ãƒã‚¤ã‚¹ãƒ™ãƒ¼ã‚¹ï¼‰
- ãƒ­ã‚°ã‚¤ãƒ³å¾Œ: `user_id`ï¼ˆèªè¨¼IDã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ï¼‰
- åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚‚æ™‚é–“è»¸ã‚„ãƒ‡ãƒã‚¤ã‚¹ã§ç•°ãªã‚‹IDãŒä»˜ä¸ã•ã‚Œã‚‹

#### 4.4.2. çµ±ä¸€ã®ä»•çµ„ã¿

ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã§ `user_pseudo_id` ã¨ `user_id` ã‚’ç´ä»˜ã‘ã€`COALESCE` ã§å„ªå…ˆé †ä½ã‚’ã¤ã‘ã¦çµ±ä¸€ã™ã‚‹ã“ã¨ã§ã€åŒ¿åè¨ªå•ã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³å¾Œã¾ã§åŒä¸€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦è¿½è·¡ã§ãã¾ã™ã€‚

#### 4.4.3. incremental ã«ãŠã‘ã‚‹åˆ¶ç´„

`touch_lookback_days` æœŸé–“å†…ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯çµ±ä¸€ã•ã‚Œã¾ã™ãŒã€æœŸé–“å¤–ã®åŒ¿åè¨ªå•ã¯å‡¦ç†ã•ã‚Œãªã„ãŸã‚ã€é•·æœŸé–“åŒ¿ååˆ©ç”¨ã—ãŸå¾Œã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨å¤ã„åŒ¿åIDã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ®‹ã‚Šã¾ã™ã€‚ãŸã ã—ã€æœ¬ãƒ¢ãƒ‡ãƒ«ã¯ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‹•å‘ã‚’é•·æœŸé–“è¿½è·¡ã™ã‚‹ã“ã¨ãŒä¸»ç›®çš„ã®ãŸã‚ã€ä½é »åº¦ã® full-refresh ã§å¯¾å¿œã™ã‚Œã°ååˆ†ã§ã™ã€‚

#### 4.4.4. æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãƒãƒ¼ãƒˆã¨ã®é•ã„

æ—¢å­˜ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£ãƒ¢ãƒ‡ãƒ«ï¼ˆ`whs_user__user_master` ãªã©ï¼‰ã¯ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ (`user_id`) ã®ã¿ã‚’å¯¾è±¡ã¨ã—ã¦ãŠã‚Šã€åŒ¿åè¨ªå•æœŸé–“ã‚’å«ã‚ãŸå…¨æœŸé–“è¿½è·¡ã¯ã“ã®ãƒ¢ãƒ‡ãƒ«ãŒåˆã‚ã¦ã®å®Ÿè£…ã¨ãªã‚Šã¾ã™ã€‚ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDçµ±ä¸€ã®ä»•çµ„ã¿ã¯éš ã‚ŒãŸæˆæœã¨è¨€ãˆã¾ã™ã€‚

### 4.5. ãã®ä»–ã®è¨­è¨ˆãƒã‚¤ãƒ³ãƒˆ

åŒã˜è¦é ˜ã§ä»¥ä¸‹ã‚‚ã‚«ãƒ©ãƒ ã¨ã—ã¦è¿½åŠ ã§ãã¾ã™ã€‚

- åˆå›è¨ªå•ãƒ»æœ€çµ‚è¨ªå•ã‚¤ãƒ™ãƒ³ãƒˆã«ç´ã¥ãæƒ…å ±
    - è¨ªå•æ™‚åˆ»ã€æµå…¥å…ƒã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€æµå…¥çµŒè·¯ãªã©

## 5. æˆæœ

### 5.1. æŠ€è¡“çš„ãªæˆæœ

- ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ£ãƒ³é‡ã¯ç´„ 1/50 ã«å‰Šæ¸›
    - full-refresh: 24.6 GiB
    - incremental: ç´„ 500 MiB (3æ—¥åˆ†ã®å·®åˆ†)
    - åˆ©ç”¨ã™ã‚‹ DWH ãŒ BigQuery ã®ãŸã‚ã‚¹ã‚­ãƒ£ãƒ³é‡å‰Šæ¸›ã¯é‡è¦
- OOM ç™ºç”Ÿãªã—
- æ›´æ–°ã‚³ã‚¹ãƒˆãŒä½ã„ï¼ˆ1æ—¥ã«è¤‡æ•°å›ã®æ›´æ–°å‡¦ç†å®Ÿè¡Œã§ã‚‚å•é¡Œãªã„ã—ã€å¤±æ•—ã—ã¦ã‚‚æ¬¡ã®æ›´æ–°ã§ãƒªã‚«ãƒãƒªå¯èƒ½ï¼‰

### 5.2. ãƒ‡ãƒ¼ã‚¿åˆ†æã¸ã®è²¢çŒ®

- æœ¬æ¥ã¯è†¨å¤§ãªãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã—ãªã„ã¨å¾—ã‚‰ã‚Œãªã„ã‚¯ã‚¨ãƒªçµæœã‚’ä½ã‚³ã‚¹ãƒˆã§å¾—ã‚‰ã‚Œã‚‹
- åˆ†æè€…ãŒæ°—è»½ã«é•·æœŸé–“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•ã‚’è¿½è·¡ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ
    - é•·æœŸé–“ã«ã‚ãŸã‚‹åˆ†æã®éœ€è¦ã‚’ä¿ƒé€²ã—ã€ãƒ¢ãƒ‡ãƒ«ã‚’æ›´ã«å……å®Ÿã•ã›ã‚‹å¥½å¾ªç’°ã‚’ç›®æŒ‡ã™

## 6. ãŠã‚ã‚Šã«

åˆå›è¨ªå•ã¨æœ€çµ‚è¨ªå•ã¨ã„ã†ç‰¹å®šã®æŒ‡æ¨™ã‚’ä¸­å¿ƒã«æ®ãˆã¦å…¨æœŸé–“è¿½è·¡ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã€Œincremental ã«å‘ã„ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆã€ã¨ã„ã†åŸºæœ¬ã‚’æŠ¼ã•ãˆã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

OOM è§£æ¶ˆã ã‘ã§ãªãã€ä½ã‚³ã‚¹ãƒˆã§ã®é‹ç”¨ã‚„æ“¬ä¼¼çš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒªã‚¹ãƒˆã¨ã„ã†å‰¯æ¬¡çš„ãªæˆæœã‚‚å¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

ä»Šå›ã®ãƒ¢ãƒ‡ãƒ«ã¯ã€é•·æœŸé–“ã®åˆ†æã«ç›®ã‚’å‘ã‘ã‚‹ãŸã‚ã®ç¬¬ä¸€æ­©ã¨ã—ã¦å°å…¥ã—ã¾ã—ãŸã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’åŸºç¤ã¨ã—ã¦ã€æ§˜ã€…ãªæ™‚é–“è»¸ã§ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•åˆ†æã‚’å††æ»‘ã«é€²ã‚ã‚‰ã‚Œã‚‹ä¸€åŠ©ã«ãªã‚Œã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

[^1]: dbt ã§ã¯ SELECT æ–‡ã§å®šç¾©ã•ã‚ŒãŸå¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ã®ã“ã¨ã‚’ãƒ¢ãƒ‡ãƒ«ã¨å‘¼ã³ã€å®Ÿè¡Œã™ã‚‹ã¨ BigQuery ãªã©ã® DWH ä¸Šã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚„ãƒ“ãƒ¥ãƒ¼ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚
